PARAMETERS IssuedDocumentIDPar Long;
SELECT ProductDetailsTransformedToFinancialTransactorsRecordsHelpQ.Debit AS NewDebit, ProductDetailsTransformedToFinancialTransactorsRecordsHelpQ.Credit AS NewCredit, ProductDetailsBackUpTransformedToFinancialTransactorsRecHelpQ.Debit AS OldDebit, ProductDetailsBackUpTransformedToFinancialTransactorsRecHelpQ.Credit AS OldCredit, ProductDetailsTransformedToFinancialTransactorsRecordsHelpQ.Is_Deleted AS NewIsDeleted, ProductDetailsBackUpTransformedToFinancialTransactorsRecHelpQ.Is_Deleted AS OldIsDeleted, ProductDetailsTransformedToFinancialTransactorsRecordsHelpQ.Product_ID AS NewProductID, ProductDetailsBackUpTransformedToFinancialTransactorsRecHelpQ.Product_ID AS OldProductID, ProductDetailsTransformedToFinancialTransactorsRecordsHelpQ.[Transactor_Product_ID(Main_Entity)] AS NewMainTransactorID, ProductDetailsBackUpTransformedToFinancialTransactorsRecHelpQ.[Transactor_Product_ID(Main_Entity)] AS OldMainTransactorID, ProductDetailsTransformedToFinancialTransactorsRecordsHelpQ.[Transactor_Product_ID(Other_Entity)] AS NewOtherTransactorID, ProductDetailsBackUpTransformedToFinancialTransactorsRecHelpQ.[Transactor_Product_ID(Other_Entity)] AS OldOtherTransactorID, ProductDetailsTransformedToFinancialTransactorsRecordsHelpQ.Vat_Transactor_ID AS NewVatTransactorID, ProductDetailsBackUpTransformedToFinancialTransactorsRecHelpQ.Vat_Transactor_ID AS OldVatTransactorID, IIf([NewIsDeleted],-Nz([OldDebit],0),[NewDebit]-Nz([OldDebit],0)) AS DebitToAdd, IIf([NewIsDeleted],-Nz([OldCredit],0),[NewCredit]-Nz([OldCredit],0)) AS CreditToAdd, IIf([NewIsDeleted],-Nz([OldVatDebit],0),[NewVatDebit]-Nz([OldVatDebit],0)) AS VatDebitToAdd, IIf([NewIsDeleted],-Nz([OldVatCredit],0),[NewVatCredit]-Nz([OldVatCredit],0)) AS VatCreditToAdd, IIf([NewIsDeleted],-Nz([OldQuantityDebit],0),[NewQuantityDebit]-Nz([OldQuantityDebit],0)) AS QuantityDebitToAdd, IIf([NewIsDeleted],-Nz([OldQuantityCredit],0),[NewQuantityCredit]-Nz([OldQuantityCredit],0)) AS QuantityCreditToAdd, ProductDetailsTransformedToFinancialTransactorsRecordsHelpQ.IssuedDocumentProductDetails_Backup_ID AS FKBackupID, ProductDetailsBackUpTransformedToFinancialTransactorsRecHelpQ.[IssuedDocumentProductDetailsBackupT.IssuedDocumentProductDetailsID_Backup_ID] AS BackupID, ProductDetailsTransformedToFinancialTransactorsRecordsHelpQ.Financial_Transactor_ID AS NewFinancialTransactorID, ProductDetailsBackUpTransformedToFinancialTransactorsRecHelpQ.Financial_Transactor_ID AS OldFinancialTransactorID, ProductDetailsTransformedToFinancialTransactorsRecordsHelpQ.QuantityDebit AS NewQuantityDebit, ProductDetailsBackUpTransformedToFinancialTransactorsRecHelpQ.QuantityDebit AS OldQuantityDebit, ProductDetailsTransformedToFinancialTransactorsRecordsHelpQ.QuantityCredit AS NewQuantityCredit, ProductDetailsBackUpTransformedToFinancialTransactorsRecHelpQ.QuantityCredit AS OldQuantityCredit, ProductDetailsTransformedToFinancialTransactorsRecordsHelpQ.VatDebit AS NewVatDebit, ProductDetailsTransformedToFinancialTransactorsRecordsHelpQ.VatCredit AS NewVatCredit, ProductDetailsBackUpTransformedToFinancialTransactorsRecHelpQ.VatDebit AS OldVatDebit, ProductDetailsBackUpTransformedToFinancialTransactorsRecHelpQ.VatCredit AS OldVatCredit, ProductDetailsTransformedToFinancialTransactorsRecordsHelpQ.Issued_Document_ID
FROM ProductDetailsTransformedToFinancialTransactorsRecordsHelpQ LEFT JOIN ProductDetailsBackUpTransformedToFinancialTransactorsRecHelpQ ON ProductDetailsTransformedToFinancialTransactorsRecordsHelpQ.IssuedDocumentProductDetails_Backup_ID = ProductDetailsBackUpTransformedToFinancialTransactorsRecHelpQ.[IssuedDocProdDetailsID_Backup_ID]
WHERE (((ProductDetailsTransformedToFinancialTransactorsRecordsHelpQ.IssuedDocumentProductDetailsT.Issued_Document_ID)=[IssuedDocumentIDPar]));

